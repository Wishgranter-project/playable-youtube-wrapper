<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <title>YouTube</title>
        <link rel="stylesheet" href="stylesheet.css" />
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
        <script type="module">
        import PlayerYouTube from '../src/PlayerYouTube.js';
        $(document).ready(function() 
        {
            window.player                       = new PlayerYouTube({width: 'auto'});
            window.currentTime                  = $('#current-time')[0];
            window.remainingTime                = $('#remaining-time')[0];
            window.progressBar                  = $('#progress-bar')[0];

            window.player.onTimeupdate          = function() 
            {
                window.currentTime.innerHTML    = this.currentTimer;
                window.remainingTime.innerHTML  = this.remainingTimer;
                window.progressBar.value        = this.currentPercentage;
            }

            $('#toggle-play-payse').click(window.player.toggle.bind(window.player));

            $('#media-list a').click(function(e) 
            {
                e.preventDefault();
                var id = this.attributes.href.value.match(/v=([A-Za-z0-9-_]+)/)[1];
                window.player.setData({id:id});

                $('#title').html($(this).find('.title').html());
                $('#artist').html($(this).find('.artist').html());
            });

            $(window.progressBar).click(function(e) 
            {
                var x, width, perc;
                x               = e.clientX - this.offsetLeft;
                width           = this.offsetWidth;
                perc            = Math.ceil((x / width) * 100)+'%';
                
                window.player.setCurrentTime(perc)
            });

            $('#volume-slider').change(function() {
                var v = parseInt($(this).val());
                window.player.setVolume(v);
            });

        });
        </script>
    </head>
    <body>
        <div id="media-player">
            <ul id="media-list">
                <li>
                    <a href="https://www.youtube.com/watch?v=fsVlfuWCRpw">
                        <span class="title">The seller of souls</span>
                        <span class="artist">Van Canto</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=FrtXkik0ey0">
                        <span class="title">To sing a metal song</span>
                        <span class="artist">Van Canto</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=I5lNvNrLlKA">
                        <span class="title">My Voice</span>
                        <span class="artist">Van Canto</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=5CqvqgGOW6I">
                        <span class="title">The Ancient Forest of Elves</span>
                        <span class="artist">Luca Turilli</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=9rDnoIaYM4o">
                        <span class="title">Stormroad</span>
                        <span class="artist">Nahtram</span>
                    </a>
                </li>
                <li>
                    <a href="https://www.youtube.com/watch?v=ZLsX9WUdYnU">
                        <span class="title">Children of the Omnissiah</span>
                        <span class="artist">Mechanicus</span>
                    </a>
                </li>
            </ul>
            <div id="youtube-wrapper"></div>
            <div id="status">
                <div id="title">---</div>
                <div id="artist">---</div>
                <div id="progress">
                    <div id="current-time">00:00</div>
                    <progress id="progress-bar" value="0" max="100"></progress>
                    <div id="remaining-time">00:00</div>
                </div>
            </div>
            <div id="buttons">
                <button id="toggle-play-payse">&#9646;&#9646; &#9654;</button>
                <input id="volume-slider" type="range" min="0" max="100" value="100" />
            </div>
        </div>
    </body>
</html>